<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>lcb_create_compat</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /></head><body><div xml:lang="en" class="refentry" lang="en"><a id="idp260576"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>lcb_create_compat — Create instance</p></div><div class="refsynopsisdiv"><a id="_synopsis"></a><h2>Synopsis</h2><p>cc [ flag … ] file… -lcouchbase [ library … ]</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;</pre><pre class="literallayout">lcb_error_t lcb_create_compat(lcb_compat_t type,
                              const void *specific,
                              lcb_t *instance,
                              struct lcb_io_opt_st *io);</pre></div><div class="refsect1"><a id="_description"></a><h2>DESCRIPTION</h2><p>lcb_create_compat creates an instance of libcouchbase with special
configuration options.</p><p>The <code class="literal">type</code> parameter specifices the type of compatibility backend to
use. The following types are defined:</p><pre class="literallayout">+LCB_MEMCACHED_CLUSTER+     Disable the REST configuration
                            protocol and connect to a fixed
                            list of memcached servers.</pre><pre class="literallayout">+LCB_CACHED_CONFIG+         Use a cached copy of the cluster
                            topology to bypass the REST
                            bootstrapping.</pre><p>The content of the <code class="literal">specific</code> parameter depends on the <code class="literal">type</code>
parameter.</p><p>See lcb_create() for more information about the <code class="literal">instance</code> and <code class="literal">io</code>
parameter.</p><div class="refsect2"><a id="_lcb_memcached_cluster"></a><h3>LCB_MEMCACHED_CLUSTER</h3><p>For <code class="literal">LCB_MEMCACHED_CLUSTER</code> the <code class="literal">specific</code> parameter points
to a struct lcb_memcached_st:</p><pre class="literallayout">struct lcb_memcached_st {
    const char *serverlist;
    const char *username;
    const char *password;
};</pre><p>The <code class="literal">serverlist</code> is a list of server separated with a
semicolon. <code class="literal">username</code> and <code class="literal">password</code> may be specified to use SASL
authentication to the memcached cluster.</p></div><div class="refsect2"><a id="_lcb_cached_config"></a><h3>LCB_CACHED_CONFIG</h3><p>For <code class="literal">LCB_MEMCACHED_CLUSTER</code> the <code class="literal">specific</code> parameter points
to a struct lcb_cached_config_st:</p><pre class="literallayout">struct lcb_cached_config_st {
    struct lcb_create_st createopt;
    const char *cachefile;
};</pre><p>See lcb_create() for a description of the internals of the <code class="literal">createopt</code>
structure. The information in the <code class="literal">createopt</code> structure is used if the
<code class="literal">cachefile</code> is missing or stale. The <code class="literal">cachefile</code> is used to specify a
file (absolute or relative) where the cluster topology is stored. If
the file exists the entire bootstrapping logic is skipped during
startup, and delayed until an error is returned from the cluster
indicating that the information in the cache is stale.</p></div></div><div class="refsect1"><a id="_return_values"></a><h2>RETURN VALUES</h2><p>lcb_create() returns the LCB_SUCCESS on success, or a specific error
code upon failure. See <a class="ulink" href="lcb_strerror.3couchbase.html" target="_top">lcb_strerror(3couchbase)</a> for more information.</p></div><div class="refsect1"><a id="_examples"></a><h2>EXAMPLES</h2><p>Example 1: Create an instance that may be used with a memcached cluster.</p><pre class="literallayout">struct lcb_memcached_st memcached;
lcb_t instance;
lcb_error_t err;</pre><pre class="literallayout">memset(&amp;memcached, 0, sizeof(memcached));
memcached.serverlist = "localhost:11211;localhost:11212";</pre><pre class="literallayout">err = lcb_create_compat(LCB_MEMCACHED_CLUSTER, &amp;memcached,
                        &amp;instance, NULL);
if (err != LCB_SUCCESS) {
    ... error ...
}</pre><p>Example 2: Create an instance that uses configuration caching:</p><pre class="literallayout">lcb_t instance;
lcb_error_t err;
struct lcb_cached_config_st config;</pre><pre class="literallayout">memset(&amp;config, 0, sizeof(config));
config.createopt.version = 1;
config.createopt.v.v1.host = "host1";
config.createopt.v.v1.user = "mybucket";
config.createopt.v.v1.passwd = "secret";
config.createopt.v.v1.bucket = "mybucket";
config.cachefile = "/var/tmp/couchbase-config-cache";</pre><pre class="literallayout">err = lcb_create_compat(LCB_CACHED_CONFIG, &amp;config,
                        &amp;instance, NULL);
if (err != LCB_SUCCESS) {
    ... error ...
}</pre></div><div class="refsect1"><a id="_attributes"></a><h2>ATTRIBUTES</h2><p>See <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a> for descriptions of the following attributes:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE TYPE      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE VALUE</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Interface Stability</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Committed</p></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>MT-Level</p></td><td style="" align="left" valign="top"><p>MT-Safe</p></td></tr></tbody></table></div></div><div class="refsect1"><a id="_see_also"></a><h2>SEE ALSO</h2><p>Copyright 2010-2013 Couchbase, Inc.</p><p>Learn more at <a class="ulink" href="http://www.couchbase.com/communities/c" target="_top">http://www.couchbase.com/communities/c</a>.</p><p><a class="ulink" href="libcouchbase.3lib.html" target="_top">libcouchbase(3lib)</a>, <a class="ulink" href="lcb_create.3couchbase.html" target="_top">lcb_create(3couchbase)</a>,
<a class="ulink" href="lcb_create_io_ops.3couchbase.html" target="_top">lcb_create_io_ops(3couchbase)</a>, <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a></p></div></div></body></html>
