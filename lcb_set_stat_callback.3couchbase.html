<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>lcb_set_stat_callback</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /></head><body><div xml:lang="en" class="refentry" lang="en"><a id="idp252096"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>lcb_set_stat_callback — Set callback for stats</p></div><div class="refsynopsisdiv"><a id="_synopsis"></a><h2>Synopsis</h2><p>cc [ flag … ] file… -lcouchbase [ library … ]</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;</pre><pre class="literallayout">lcb_stat_callback lcb_set_stat_callback(lcb_t, lcb_stat_callback);</pre></div><div class="refsect1"><a id="_description"></a><h2>DESCRIPTION</h2><p>lcb_set_stat_callback() is used to set a new callback function
to handle server stat commands for a given libcouchbase instance.</p><p>The callback parameter is a the callback function to call for each
stat response. Passing NULL as the callback function may be used
to query the current callback function. The lcb_stat_callback is
a function with the following signature:</p><pre class="literallayout">void function(lcb_t instance,
              const void *cookie,
              lcb_error_t error,
              lcb_server_stat_resp_t *resp);</pre><p>instance is the libcouchbase instance that this response is called
from. The cookie is cookie you passed to lcb_server_stats. error is the
error status of this operation. If the error is LCB_SUCCESS the resp
is a pointer to the result for the operation. lcb_server_stat_resp_t is
a structure defined in &lt;libcouchbase/arguments.h&gt;:</p><pre class="literallayout">typedef struct lcb_server_stat_resp_st {
    int version; /* The entry in "v" to use */
    union {
        struct {
            const char *server_endpoint; /* which server reported this */
            const void *key;       /* The stat key */
            lcb_size_t nkey;       /* The length of the stat key */
            const void *bytes;     /* The value for the key */
            lcb_size_t nbytes;     /* The number of bytes in the value */
        } v0;
    } v;
} lcb_server_stat_resp_t;</pre><p>The callback function will be called multiple times (one time per
server statistic) with a final call with server_enpoint set to
NULL to indicate the last invocation of the callback.</p></div><div class="refsect1"><a id="_return_values"></a><h2>RETURN VALUES</h2><p>lcb_set_stat_callback() returns the previous callback function.</p></div><div class="refsect1"><a id="_examples"></a><h2>EXAMPLES</h2><p>Example 1: Query the current callback</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;</pre><pre class="literallayout">...
lcb_t instance;
...
lcb_stat_callback old;
old = lcb_set_stat_callback(instance, NULL);
...</pre><p>Example 2: Install custom callback</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;</pre><pre class="literallayout">...
static void callback(lcb_t instance, const void *cookie,
                     lcb_error_t error,
                     const lcb_stat_resp_t *resp)
{
   if (error == LCB_SUCCESS) {
      switch (resp-&gt;version) {
          ...
          /* handle the known formats */
          ...
      default:
          /* handle unknown formats */
      }
   } else {
      /* handle errors */
   }
}</pre><pre class="literallayout">...
lcb_t instance;
...
lcb_set_stat_callback(instance, callback);
...</pre></div><div class="refsect1"><a id="_attributes"></a><h2>ATTRIBUTES</h2><p>See <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a> for descriptions of the following attributes:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE TYPE      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE VALUE</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Interface Stability</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Committed</p></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>MT-Level</p></td><td style="" align="left" valign="top"><p>MT-Safe</p></td></tr></tbody></table></div></div><div class="refsect1"><a id="_see_also"></a><h2>SEE ALSO</h2><p>Copyright 2010-2013 Couchbase, Inc.</p><p>Learn more at <a class="ulink" href="http://www.couchbase.com/communities/c" target="_top">http://www.couchbase.com/communities/c</a>.</p><p><a class="ulink" href="libcouchbase.3lib.html" target="_top">libcouchbase(3lib)</a>, <a class="ulink" href="lcb_server_stats.3couchbase.html" target="_top">lcb_server_stats(3couchbase)</a>, <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a></p></div></div></body></html>
