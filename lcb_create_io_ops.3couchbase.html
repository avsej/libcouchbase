<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>lcb_create_io_ops</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /></head><body><div xml:lang="en" class="refentry" lang="en"><a id="idp161776"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>lcb_create_io_ops — Create IO ops instance</p></div><div class="refsynopsisdiv"><a id="_synopsis"></a><h2>Synopsis</h2><p>cc [ flag … ] file… -lcouchbase [ library … ]</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;</pre><pre class="literallayout">lcb_error_t lcb_create_io_ops(lcb_io_opt_t *op,
                              const struct lcb_create_io_ops_st *options);</pre></div><div class="refsect1"><a id="_description"></a><h2>DESCRIPTION</h2><p>lcb_create_io_ops() is used to create an instance of the IO operations
to use from libcouchbase. The newly created IO operation structure is
returned in the <code class="literal">op</code> parameter.</p><p><code class="literal">lcb_create_io_ops_st</code> is defined in &lt;libcouchbase/arguments.h&gt; and
looks like:</p><pre class="literallayout">struct lcb_create_io_ops_st {
    int version;
    union {
        struct {
            lcb_io_ops_type_t type;
            void *cookie;
        } v0;
        struct {
            const char *sofile;
            const char *symbol;
            void *cookie;
        } v1;
    } v;
};</pre><p>The <code class="literal">version</code> member specifies which entry in <code class="literal">v</code> to use. <code class="literal">v0</code> is the
simplest version that allows you to specify a predefined version to
use:</p><pre class="literallayout">LCB_IO_OPS_DEFAULT    Use the default IO ops for this platform</pre><pre class="literallayout">LCB_IO_OPS_LIBEVENT   Use libevent. +cookie+ may be specified
                      to utilize given event_base.</pre><pre class="literallayout">LCB_IO_OPS_WINSOCK    Use Windows sockets</pre><pre class="literallayout">LCB_IO_OPS_LIBEV      Use libev.</pre><p><code class="literal">v1</code> allows for more flexibility. <code class="literal">sofile</code> specifies the shared object
containing the function used to create and initialize the IO
operation. Some runtime linkers allows this parameter to be set to
NULL to search for the object in the current application. <code class="literal">symbol</code>
contains the name of the function to call to create and initialize the
IO ops structure. The symbol must be a function with the following
signature:</p><pre class="literallayout">lcb_error_t create(lcb_io_opt_t *io, const void *cookie);</pre><p>The function should return the newly created IO ops though the <code class="literal">io</code>
parameter. The <code class="literal">cookie</code> parameter is the same value as specified as
<code class="literal">cookie</code> in the <code class="literal">v1</code> structure. If successful the function should
return LCB_SUCCESS.</p><p>lcb_io_opt_t is a structure defined in &lt;libcouchbase/types.h&gt; with the
following layout:</p><pre class="literallayout">struct lcb_io_opt_st {
    int version;
    void *dlhandle;
    void (*destructor)(struct lcb_io_opt_st *iops);
    union {
        struct {
            void *cookie;
            int error;
            int need_cleanup;
            lcb_socket_t (*socket)(struct lcb_io_opt_st *iops,
                                   int domain,
                                   int type,
                                   int protocol);
            int (*connect)(struct lcb_io_opt_st *iops,
                           lcb_socket_t sock,
                           const struct sockaddr *name,
                           unsigned int namelen);
            lcb_ssize_t (*recv)(struct lcb_io_opt_st *iops,
                                lcb_socket_t sock,
                                void *buffer,
                                lcb_size_t len,
                                int flags);
            lcb_ssize_t (*send)(struct lcb_io_opt_st *iops,
                                lcb_socket_t sock,
                                const void *msg,
                                lcb_size_t len,
                                int flags);
            lcb_ssize_t (*recvv)(struct lcb_io_opt_st *iops,
                                 lcb_socket_t sock,
                                 struct lcb_iovec_st *iov,
                                 lcb_size_t niov);
            lcb_ssize_t (*sendv)(struct lcb_io_opt_st *iops,
                                 lcb_socket_t sock,
                                 struct lcb_iovec_st *iov,
                                 lcb_size_t niov);
            void (*close)(struct lcb_io_opt_st *iops,
                          lcb_socket_t sock);
            void *(*create_timer)(struct lcb_io_opt_st *iops);
            void (*destroy_timer)(struct lcb_io_opt_st *iops,
                                  void *timer);
            void (*delete_timer)(struct lcb_io_opt_st *iops,
                                 void *timer);
            int (*update_timer)(struct lcb_io_opt_st *iops,
                                void *timer,
                                lcb_uint32_t usec,
                                void *cb_data,
                                void (*handler)(lcb_socket_t sock,
                                                short which,
                                                void *cb_data));
            void *(*create_event)(struct lcb_io_opt_st *iops);
            void (*destroy_event)(struct lcb_io_opt_st *iops,
                                  void *event);
            int (*update_event)(struct lcb_io_opt_st *iops,
                                lcb_socket_t sock,
                                void *event,
                                short flags,
                                void *cb_data,
                                void (*handler)(lcb_socket_t sock,
                                                short which,
                                                void *cb_data));
            void (*delete_event)(struct lcb_io_opt_st *iops,
                                 lcb_socket_t sock,
                                 void *event);
            void (*stop_event_loop)(struct lcb_io_opt_st *iops);
            void (*run_event_loop)(struct lcb_io_opt_st *iops);
        } v0;
    } v;
};</pre><p>If you have questions about the internal layout of this structure
please ask us on IRC (irc.freenode.net) in the #libcouchbase channel</p></div><div class="refsect1"><a id="_return_values"></a><h2>RETURN VALUES</h2><p>lcb_create() returns the LCB_SUCCESS on success, or a specific error
code upon failure. See <a class="ulink" href="lcb_strerror.3couchbase.html" target="_top">lcb_strerror(3couchbase)</a> for more information.</p></div><div class="refsect1"><a id="_attributes"></a><h2>ATTRIBUTES</h2><p>See <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a> for descriptions of the following attributes:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE TYPE      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE VALUE</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Interface Stability</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Committed</p></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>MT-Level</p></td><td style="" align="left" valign="top"><p>MT-Safe</p></td></tr></tbody></table></div></div><div class="refsect1"><a id="_see_also"></a><h2>SEE ALSO</h2><p>Copyright 2010-2013 Couchbase, Inc.</p><p>Learn more at <a class="ulink" href="http://www.couchbase.com/communities/c" target="_top">http://www.couchbase.com/communities/c</a>.</p><p><a class="ulink" href="libcouchbase.3lib.html" target="_top">libcouchbase(3lib)</a>, <a class="ulink" href="lcb_create.3couchbase.html" target="_top">lcb_create(3couchbase)</a>, <a class="ulink" href="lcb_create_compat.3couchbase.html" target="_top">lcb_create_compat(3couchbase)</a>,
<a class="ulink" href="lcb_destroy_io_ops.3couchbase.html" target="_top">lcb_destroy_io_ops(3couchbase)</a>, <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a></p></div></div></body></html>
