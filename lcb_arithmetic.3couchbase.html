<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>lcb_arithmetic</title><link rel="stylesheet" type="text/css" href="docbook-xsl.css" /><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /></head><body><div xml:lang="en" class="refentry" lang="en"><a id="idp168384"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>lcb_arithmetic — Perform arithmetic operations</p></div><div class="refsynopsisdiv"><a id="_synopsis"></a><h2>Synopsis</h2><p>cc [ flag … ] file… -lcouchbase [ library … ]</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;</pre><pre class="literallayout">lcb_error_t lcb_arithmetic(lcb_t instance,
                           const void *command_cookie,
                           lcb_size_t num,
                           const lcb_arithmetic_cmd_t *const *commands);</pre></div><div class="refsect1"><a id="_description"></a><h2>DESCRIPTION</h2><p>lcb_arithmetic() is used to perform a arithmetic operations on a
document’s value. If the library instance is using asynchronous mode
(the default) this operation will return immediately and schedule the
operations to be executed by the event loop, otherwise it will block
until all commands are executed. command_cookie is is an opaque field
that will be provided to the callback function. num is the number of
entries in the commands array.</p><p>lcb_arithmetic_cmd_t is a structure defined in &lt;libcouchbase/arguments.h&gt;:</p><pre class="literallayout">typedef struct lcb_arithmetic_cmd_st {
         int version;              /* The enty in "v" to use */
         union {
            struct {
               const void *key;    /* The key this response belongs to */
               lcb_size_t nkey;    /* The number of bytes in the key */
               lcb_time_t exptime; /* The documents expiry time */
               int create;         /* create non-existent documents */
               lcb_int64_t delta;  /* amount to add/subtract */
               lcb_uint64_t initial; /* initial value if creating */
               const void *hashkey; /* hash key if != key */
               lcb_size_t nhashkey; /* number of bytes in hash key */
            } v0;
         } v;
      };</pre><p>Please note that using an alternate key for hashing may lead to an
unbalanced cluster if the key does not hash evenly with a crc32.</p><p>Upon completion the arithmetic callback as set by
lcb_set_arithmetic_callback is called.</p></div><div class="refsect1"><a id="_return_values"></a><h2>RETURN VALUES</h2><p>lcb_arithmetic() returns the LCB_SUCCESS on success, or a specific
error code upon failure. See <a class="ulink" href="lcb_strerror.3couchbase.html" target="_top">lcb_strerror(3couchbase)</a> for more
information.</p></div><div class="refsect1"><a id="_examples"></a><h2>EXAMPLES</h2><p>Example 1: Query the current callback</p><pre class="literallayout">#include &lt;libcouchbase/couchbase.h&gt;
...
lcb_t instance;
...
lcb_arithmetic_cmd_t *arithmetic = calloc(1, sizeof(*arithmetic));
arithmetic-&gt;version = 0;
arithmetic-&gt;v.v0.key = "counter";
arithmetic-&gt;v.v0.nkey = strlen(arithmetic-&gt;v.v0.key);
arithmetic-&gt;v.v0.initial = 0x666;
arithmetic-&gt;v.v0.create = 1;
arithmetic-&gt;v.v0.delta = 1;
lcb_arithmetic_cmd_t* commands[] = { arithmetic };
lcb_arithmetic(instance, NULL, 1, commands);
...</pre></div><div class="refsect1"><a id="_attributes"></a><h2>ATTRIBUTES</h2><p>See <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a> for descriptions of the following attributes:</p><div class="informaltable"><table cellpadding="4px" style="border-collapse: collapse;border-top: 3px solid #527bbd; border-bottom: 3px solid #527bbd; border-left: 3px solid #527bbd; border-right: 3px solid #527bbd; "><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE TYPE      </th><th style="border-bottom: 1px solid #527bbd; " align="left" valign="top"> ATTRIBUTE VALUE</th></tr></thead><tbody><tr><td style="border-right: 1px solid #527bbd; border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Interface Stability</p></td><td style="border-bottom: 1px solid #527bbd; " align="left" valign="top"><p>Committed</p></td></tr><tr><td style="border-right: 1px solid #527bbd; " align="left" valign="top"><p>MT-Level</p></td><td style="" align="left" valign="top"><p>MT-Safe</p></td></tr></tbody></table></div></div><div class="refsect1"><a id="_see_also"></a><h2>SEE ALSO</h2><p>Copyright 2010-2013 Couchbase, Inc.</p><p>Learn more at <a class="ulink" href="http://www.couchbase.com/communities/c" target="_top">http://www.couchbase.com/communities/c</a>.</p><p><a class="ulink" href="libcouchbase.3lib.html" target="_top">libcouchbase(3lib)</a>, <a class="ulink" href="lcb_get_arithmetic_callback.3couchbase.html" target="_top">lcb_get_arithmetic_callback(3couchbase)</a>,
<a class="ulink" href="lcb_set_arithmetic_callback.3couchbase.html" target="_top">lcb_set_arithmetic_callback(3couchbase)</a>, <a class="ulink" href="lcb_attributes.5.html" target="_top">lcb_attributes(5)</a></p></div></div></body></html>
